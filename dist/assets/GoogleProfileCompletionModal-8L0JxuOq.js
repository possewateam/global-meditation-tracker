var e=Object.defineProperty,__name=(t,n)=>e(t,"name",{value:n,configurable:!0});import{u as t,r as n,j as r,a1 as a,N as o,a7 as s,a8 as i,G as l,aa as c,c as d,ab as m}from"./vendor-react-B3cVin9Q.js";import{r as h}from"./location-dcz9V2s_.js";import{r as u,f as b}from"./geocoding-ryAQYms7.js";import"./vendor-other-D9QTidg2.js";import"./vendor-three-DgmlkwHn.js";import"./vendor-i18n-DgyYewF3.js";const p=__name(({isOpen:e,userName:p,userEmail:x,onComplete:g})=>{const{t:w}=t(),[j,N]=n.useState({name:p,bk_centre_name:"",mobile_e164:""}),[f,v]=n.useState({}),[_,y]=n.useState("idle"),[k,C]=n.useState(""),[S,P]=n.useState(!1),[q,B]=n.useState(""),[D,E]=n.useState({name:"",mobile_e164:"",bk_centre_name:""});n.useEffect(()=>{e&&(N(e=>({...e,name:p})),M())},[e,p]);const M=__name(async()=>{y("requesting"),C("");try{const e=await h(),t=await u(e.latitude,e.longitude);if(t.success){const n={...t,latitude:e.latitude,longitude:e.longitude,location_source:"gps",address_source:"gps_geocoded",location_accuracy:e.accuracy};v(n),y("success")}else C(t.error||"Failed to get address from location"),y("error")}catch(e){"PERMISSION_DENIED"===e.code?(y("denied"),C("Location permission denied. You can enter your location manually.")):(y("error"),C("Unable to get location. You can enter it manually."))}},"requestLocationPermission"),F=__name(e=>e?/^[A-Za-z ]+$/.test(e)?"":"Name should only contain letters and spaces":"Name is required","validateName"),G=__name(e=>e?"":"BK Centre Name is required","validateCentreName"),I=__name(e=>e?e.replace(/\D/g,"").length<10?"Please enter a valid 10-digit mobile number":"":"Mobile number is required","validateMobileNumber"),L=__name(()=>j.name&&j.bk_centre_name&&j.mobile_e164&&!D.name&&!D.mobile_e164&&!D.bk_centre_name,"isFormValid"),$=__name(e=>{const t=e.startsWith("+")?e:`+${e}`;N(e=>({...e,mobile_e164:t})),E(t=>({...t,mobile_e164:I(e)}))},"handlePhoneChange"),z=__name(async e=>{e.preventDefault(),B(""),P(!0);const t=F(j.name),n=G(j.bk_centre_name),r=I(j.mobile_e164);if(t||n||r)return E({name:t,bk_centre_name:n,mobile_e164:r}),void P(!1);const a={name:j.name,bk_centre_name:j.bk_centre_name,mobile_e164:j.mobile_e164,...f},o=await g(a);o.success||(B(o.error||"Failed to complete profile. Please try again."),P(!1))},"handleSubmit");return e?r.jsxs("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:[r.jsxs("div",{className:"bg-gradient-to-br from-blue-900 via-teal-800 to-emerald-900 rounded-2xl p-8 shadow-2xl border border-white/20 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex items-center justify-center gap-3 mb-6",children:[r.jsx(a,{className:"w-10 h-10 text-teal-300"}),r.jsx("h2",{className:"text-3xl font-bold text-white",children:"Complete Your Profile"})]}),r.jsx("p",{className:"text-teal-200 text-center mb-6",children:"Welcome! Please complete your profile to continue"}),r.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-4 mb-6 border border-white/20",children:[r.jsx("p",{className:"text-white/70 text-sm mb-1",children:"Signed in with Google"}),r.jsx("p",{className:"text-white font-semibold",children:x})]}),r.jsxs("form",{onSubmit:z,className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-2 text-white mb-2 font-medium",children:[r.jsx(a,{className:"w-4 h-4"}),w("auth.name")]}),r.jsx("input",{type:"text",value:j.name,onChange:__name(e=>{const t=e.target.value;N({...j,name:t}),E(e=>({...e,name:F(t)}))},"onChange"),onBlur:__name(e=>E(t=>({...t,name:F(e.target.value)})),"onBlur"),className:`w-full px-4 py-3 bg-white/10 border ${D.name?"border-red-500":"border-white/20"} rounded-lg text-white placeholder-white/50 focus:outline-none focus:border-teal-400 transition-colors`,placeholder:w("auth.namePlaceholder"),required:!0}),D.name&&r.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-2 text-white mb-2 font-medium",children:[r.jsx(o,{className:"w-4 h-4"}),"BK Centre Name"]}),r.jsx("input",{type:"text",value:j.bk_centre_name,onChange:__name(e=>{const t=e.target.value;N({...j,bk_centre_name:t}),E(e=>({...e,bk_centre_name:G(t)}))},"onChange"),onBlur:__name(e=>E(t=>({...t,bk_centre_name:G(e.target.value)})),"onBlur"),className:`w-full px-4 py-3 bg-white/10 border ${D.bk_centre_name?"border-red-500":"border-white/20"} rounded-lg text-white placeholder-white/50 focus:outline-none focus:border-teal-400 transition-colors`,placeholder:"Enter your BK Centre name",required:!0}),D.bk_centre_name&&r.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.bk_centre_name})]}),r.jsxs("div",{children:[r.jsxs("label",{className:"flex items-center gap-2 text-white mb-2 font-medium",children:[r.jsx(s,{className:"w-4 h-4"}),w("auth.mobileNumber")]}),r.jsx("div",{className:"phone-input-wrapper",children:r.jsx(i,{country:"in",value:j.mobile_e164,onChange:$,inputClass:D.mobile_e164?"phone-input-error":"",containerClass:"phone-input-container",buttonClass:"phone-input-button",dropdownClass:"phone-input-dropdown",inputProps:{required:!0,autoFocus:!1},countryCodeEditable:!1,disableDropdown:!1,enableSearch:!0,searchPlaceholder:"Search country"})}),D.mobile_e164&&r.jsx("p",{className:"text-red-400 text-sm mt-1",children:D.mobile_e164})]}),r.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[r.jsx(l,{className:"w-5 h-5 text-teal-400"}),r.jsx("h3",{className:"text-white font-semibold",children:"Location Information"})]}),"requesting"===_&&r.jsxs("div",{className:"flex items-center gap-3 text-teal-300",children:[r.jsx(c,{className:"w-5 h-5 animate-spin"}),r.jsx("span",{children:"Detecting your location..."})]}),"success"===_&&f&&r.jsxs("div",{className:"space-y-3",children:[r.jsxs("div",{className:"flex items-start gap-2 text-green-400 mb-2",children:[r.jsx(d,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),r.jsxs("div",{children:[r.jsx("p",{className:"font-medium",children:"Location detected successfully!"}),r.jsx("p",{className:"text-sm text-teal-300 mt-1",children:b(f)})]})]}),r.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[f.country&&r.jsxs("div",{children:[r.jsx("label",{className:"text-white/70 block mb-1",children:"Country"}),r.jsx("div",{className:"bg-white/5 px-3 py-2 rounded text-white border border-white/10",children:f.country})]}),f.state&&r.jsxs("div",{children:[r.jsx("label",{className:"text-white/70 block mb-1",children:"State"}),r.jsx("div",{className:"bg-white/5 px-3 py-2 rounded text-white border border-white/10",children:f.state})]}),f.district&&r.jsxs("div",{children:[r.jsx("label",{className:"text-white/70 block mb-1",children:"District"}),r.jsx("div",{className:"bg-white/5 px-3 py-2 rounded text-white border border-white/10",children:f.district})]}),f.city_town&&r.jsxs("div",{children:[r.jsx("label",{className:"text-white/70 block mb-1",children:"City/Town"}),r.jsx("div",{className:"bg-white/5 px-3 py-2 rounded text-white border border-white/10",children:f.city_town})]})]}),f.location_accuracy&&r.jsxs("p",{className:"text-xs text-teal-400 flex items-center gap-1 mt-2",children:[r.jsx(m,{className:"w-3 h-3"}),"GPS Accuracy: Â±",Math.round(f.location_accuracy),"m"]})]}),("error"===_||"denied"===_)&&r.jsxs("div",{className:"space-y-3",children:[r.jsx("div",{className:"p-3 bg-orange-500/10 border border-orange-500/30 rounded text-orange-300 text-sm",children:k}),r.jsxs("button",{type:"button",onClick:M,className:"w-full py-2 bg-white/10 hover:bg-white/20 text-white rounded-lg text-sm transition-colors flex items-center justify-center gap-2",children:[r.jsx(m,{className:"w-4 h-4"}),"Try Again"]})]})]}),q&&r.jsx("div",{className:"p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-red-200 text-sm",children:q}),r.jsx("button",{type:"submit",disabled:S||!L(),className:"w-full py-3 bg-gradient-to-r from-teal-500 to-emerald-600 text-white rounded-lg font-semibold hover:shadow-lg hover:shadow-teal-500/50 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",children:S?w("common.loading"):"Complete Profile"})]})]}),r.jsx("style",{children:"\n        .phone-input-container {\n          width: 100%;\n        }\n\n        .phone-input-container input {\n          width: 100% !important;\n          height: 48px;\n          background: rgba(255, 255, 255, 0.1) !important;\n          border: 1px solid rgba(255, 255, 255, 0.2) !important;\n          border-radius: 0.5rem !important;\n          color: white !important;\n          font-size: 1rem;\n          padding-left: 48px !important;\n        }\n\n        .phone-input-container input::placeholder {\n          color: rgba(255, 255, 255, 0.5) !important;\n        }\n\n        .phone-input-container input:focus {\n          outline: none !important;\n          border-color: rgb(45, 212, 191) !important;\n        }\n\n        .phone-input-error {\n          border-color: rgb(239, 68, 68) !important;\n        }\n\n        .phone-input-button {\n          background: rgba(255, 255, 255, 0.1) !important;\n          border: 1px solid rgba(255, 255, 255, 0.2) !important;\n          border-right: none !important;\n          border-radius: 0.5rem 0 0 0.5rem !important;\n        }\n\n        .phone-input-button:hover {\n          background: rgba(255, 255, 255, 0.15) !important;\n        }\n\n        .phone-input-dropdown {\n          background: rgb(17, 94, 89) !important;\n          color: white !important;\n          border: 1px solid rgba(255, 255, 255, 0.2) !important;\n        }\n\n        .phone-input-dropdown .search {\n          background: rgba(255, 255, 255, 0.1) !important;\n          border: 1px solid rgba(255, 255, 255, 0.2) !important;\n        }\n\n        .phone-input-dropdown .search input {\n          background: transparent !important;\n          color: white !important;\n        }\n\n        .phone-input-dropdown .country:hover {\n          background: rgba(255, 255, 255, 0.1) !important;\n        }\n\n        .phone-input-dropdown .country.highlight {\n          background: rgba(45, 212, 191, 0.2) !important;\n        }\n      "})]}):null},"GoogleProfileCompletionModal");export{p as GoogleProfileCompletionModal};
