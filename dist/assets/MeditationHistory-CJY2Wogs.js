import{u as D,r as l,j as e,ab as _,C as m,ac as A,O as C,a as T,N as O}from"./vendor-react-CsWuKxj5.js";import{s as $}from"./page-admin-DgYsNXAM.js";import{u as E}from"./index-DwrExZEh.js";import"./vendor-other-D2N4SXMU.js";import"./vendor-three-WWH58ZbN.js";import"./vendor-i18n-CPrbmvBl.js";import"./vendor-supabase-D4rA0elu.js";const R=()=>{const{t:a}=D(),{user:o}=E(),[x,u]=l.useState([]),[n,p]=l.useState({totalSessions:0,totalMinutes:0,longestSession:0,averageSession:0}),[c,g]=l.useState("all"),[b,h]=l.useState(!0);l.useEffect(()=>{o&&j()},[o,c]);const f=()=>{const t=new Date;switch(c){case"today":return new Date(t.setHours(0,0,0,0)).toISOString();case"week":return new Date(t.setDate(t.getDate()-7)).toISOString();case"month":return new Date(t.setMonth(t.getMonth()-1)).toISOString();default:return null}},j=async()=>{if(!o)return;h(!0);let t=$.from("meditation_sessions").select("*").eq("user_id",o.id).not("duration_seconds","is",null).order("start_time",{ascending:!1});const s=f();s&&(t=t.gte("start_time",s));const{data:r,error:i}=await t;!i&&r&&(u(r),w(r)),h(!1)},w=t=>{const s=t.length,r=t.reduce((d,M)=>d+(M.duration_seconds||0),0),i=Math.floor(r/60),y=Math.floor(Math.max(...t.map(d=>d.duration_seconds||0))/60),k=s>0?Math.floor(r/s/60):0;p({totalSessions:s,totalMinutes:i,longestSession:y,averageSession:k})},N=t=>{if(!t)return"0m";const s=Math.floor(t/60),r=t%60;return`${s}m ${r}s`},v=t=>t?new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"",S=t=>t?new Date(t).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):"";return o?e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:a("history.title")}),e.jsx("p",{className:"text-teal-300",children:a("history.subtitle")})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gradient-to-br from-teal-500/20 to-emerald-500/20 backdrop-blur-lg rounded-xl p-6 border border-teal-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(_,{className:"w-6 h-6 text-teal-300"}),e.jsx("p",{className:"text-teal-200 text-sm font-medium",children:a("history.totalSessions")})]}),e.jsx("p",{className:"text-3xl font-bold text-white",children:n.totalSessions})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 backdrop-blur-lg rounded-xl p-6 border border-blue-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(m,{className:"w-6 h-6 text-blue-300"}),e.jsx("p",{className:"text-blue-200 text-sm font-medium",children:a("history.totalTime")})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:[n.totalMinutes,"m"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-lg rounded-xl p-6 border border-purple-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(A,{className:"w-6 h-6 text-purple-300"}),e.jsx("p",{className:"text-purple-200 text-sm font-medium",children:a("history.longestSession")})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:[n.longestSession,"m"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-500/20 to-red-500/20 backdrop-blur-lg rounded-xl p-6 border border-orange-500/30",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(C,{className:"w-6 h-6 text-orange-300"}),e.jsx("p",{className:"text-orange-200 text-sm font-medium",children:a("history.averageSession")})]}),e.jsxs("p",{className:"text-3xl font-bold text-white",children:[n.averageSession,"m"]})]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[e.jsx("div",{className:"flex gap-2 mb-6",children:["all","today","week","month"].map(t=>e.jsx("button",{onClick:()=>g(t),className:`px-4 py-2 rounded-lg font-medium transition-all ${c===t?"bg-teal-500 text-white shadow-lg":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:a(`history.filter.${t}`)},t))}),b?e.jsx("div",{className:"text-center py-12 text-white/70",children:a("common.loading")}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(m,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),e.jsx("p",{className:"text-white/70",children:a("history.noSessions")})]}):e.jsx("div",{className:"space-y-4",children:x.map(t=>e.jsx("div",{className:"bg-white/5 rounded-lg p-4 hover:bg-white/10 transition-all",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(T,{className:"w-4 h-4 text-teal-300"}),e.jsx("span",{className:"text-white font-medium",children:v(t.start_time)}),e.jsx("span",{className:"text-white/60",children:"â€¢"}),e.jsx("span",{className:"text-white/70",children:S(t.start_time)})]}),t.location&&e.jsxs("div",{className:"flex items-center gap-2 text-white/60 text-sm",children:[e.jsx(O,{className:"w-4 h-4"}),e.jsx("span",{children:t.location})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{className:"w-5 h-5 text-teal-400"}),e.jsx("span",{className:"text-2xl font-bold text-white",children:N(t.duration_seconds)})]})]})},t.id))})]})]}):null};export{R as MeditationHistory};
