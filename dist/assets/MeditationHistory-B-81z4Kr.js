var e=Object.defineProperty,__name=(t,s)=>e(t,"name",{value:s,configurable:!0});import{u as t,r as s,j as a,ac as r,C as l,ad as i,O as o,a as n,N as d}from"./vendor-react-B3cVin9Q.js";import{s as c}from"./page-admin-cU6anLI0.js";import{u as m}from"./index-BxZ87--W.js";import"./vendor-other-D9QTidg2.js";import"./vendor-three-DgmlkwHn.js";import"./vendor-i18n-DgyYewF3.js";import"./vendor-supabase-BYHeWUli.js";const x=__name(()=>{const{t:e}=t(),{user:x}=m(),[h,u]=s.useState([]),[b,p]=s.useState({totalSessions:0,totalMinutes:0,longestSession:0,averageSession:0}),[g,j]=s.useState("all"),[f,N]=s.useState(!0);s.useEffect(()=>{x&&v()},[x,g]);const w=__name(()=>{const e=new Date;switch(g){case"today":return new Date(e.setHours(0,0,0,0)).toISOString();case"week":return new Date(e.setDate(e.getDate()-7)).toISOString();case"month":return new Date(e.setMonth(e.getMonth()-1)).toISOString();default:return null}},"getDateFilter"),v=__name(async()=>{if(!x)return;N(!0);let e=c.from("meditation_sessions").select("*").eq("user_id",x.id).not("duration_seconds","is",null).order("start_time",{ascending:!1});const t=w();t&&(e=e.gte("start_time",t));const{data:s,error:a}=await e;!a&&s&&(u(s),S(s)),N(!1)},"fetchSessions"),S=__name(e=>{const t=e.length,s=e.reduce((e,t)=>e+(t.duration_seconds||0),0),a=Math.floor(s/60),r=Math.floor(Math.max(...e.map(e=>e.duration_seconds||0))/60),l=t>0?Math.floor(s/t/60):0;p({totalSessions:t,totalMinutes:a,longestSession:r,averageSession:l})},"calculateStats"),y=__name(e=>e?`${Math.floor(e/60)}m ${e%60}s`:"0m","formatDuration"),D=__name(e=>e?new Date(e).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}):"","formatDate"),k=__name(e=>e?new Date(e).toLocaleTimeString(void 0,{hour:"2-digit",minute:"2-digit"}):"","formatTime");return x?a.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:e("history.title")}),a.jsx("p",{className:"text-teal-300",children:e("history.subtitle")})]}),a.jsx("div",{className:"mb-6",children:a.jsx("a",{href:"/",className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 text-white rounded-lg font-semibold hover:bg-white/20 transition-all duration-300 border border-teal-500/30",children:e("common.backToDashboard")})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[a.jsxs("div",{className:"bg-gradient-to-br from-teal-500/20 to-emerald-500/20 backdrop-blur-lg rounded-xl p-6 border border-teal-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(r,{className:"w-6 h-6 text-teal-300"}),a.jsx("p",{className:"text-teal-200 text-sm font-medium",children:e("history.totalSessions")})]}),a.jsx("p",{className:"text-3xl font-bold text-white",children:b.totalSessions})]}),a.jsxs("div",{className:"bg-gradient-to-br from-blue-500/20 to-cyan-500/20 backdrop-blur-lg rounded-xl p-6 border border-blue-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(l,{className:"w-6 h-6 text-blue-300"}),a.jsx("p",{className:"text-blue-200 text-sm font-medium",children:e("history.totalTime")})]}),a.jsxs("p",{className:"text-3xl font-bold text-white",children:[b.totalMinutes,"m"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-purple-500/20 to-pink-500/20 backdrop-blur-lg rounded-xl p-6 border border-purple-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(i,{className:"w-6 h-6 text-purple-300"}),a.jsx("p",{className:"text-purple-200 text-sm font-medium",children:e("history.longestSession")})]}),a.jsxs("p",{className:"text-3xl font-bold text-white",children:[b.longestSession,"m"]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-orange-500/20 to-red-500/20 backdrop-blur-lg rounded-xl p-6 border border-orange-500/30",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(o,{className:"w-6 h-6 text-orange-300"}),a.jsx("p",{className:"text-orange-200 text-sm font-medium",children:e("history.averageSession")})]}),a.jsxs("p",{className:"text-3xl font-bold text-white",children:[b.averageSession,"m"]})]})]}),a.jsxs("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 mb-6",children:[a.jsx("div",{className:"flex gap-2 mb-6",children:["all","today","week","month"].map(t=>a.jsx("button",{onClick:__name(()=>j(t),"onClick"),className:"px-4 py-2 rounded-lg font-medium transition-all "+(g===t?"bg-teal-500 text-white shadow-lg":"bg-white/10 text-white/70 hover:bg-white/20"),children:e(`history.filter.${t}`)},t))}),f?a.jsx("div",{className:"text-center py-12 text-white/70",children:e("common.loading")}):0===h.length?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(l,{className:"w-16 h-16 text-white/30 mx-auto mb-4"}),a.jsx("p",{className:"text-white/70",children:e("history.noSessions")})]}):a.jsx("div",{className:"space-y-4",children:h.map(e=>a.jsx("div",{className:"bg-white/5 rounded-lg p-4 hover:bg-white/10 transition-all",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx(n,{className:"w-4 h-4 text-teal-300"}),a.jsx("span",{className:"text-white font-medium",children:D(e.start_time)}),a.jsx("span",{className:"text-white/60",children:"â€¢"}),a.jsx("span",{className:"text-white/70",children:k(e.start_time)})]}),e.location&&a.jsxs("div",{className:"flex items-center gap-2 text-white/60 text-sm",children:[a.jsx(d,{className:"w-4 h-4"}),a.jsx("span",{children:e.location})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(l,{className:"w-5 h-5 text-teal-400"}),a.jsx("span",{className:"text-2xl font-bold text-white",children:y(e.duration_seconds)})]})]})},e.id))})]})]}):null},"MeditationHistory");export{x as MeditationHistory};
